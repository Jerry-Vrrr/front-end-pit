{"ast":null,"code":"import React,{useContext,useState,useEffect}from'react';import{useNavigate}from'react-router-dom';// Import useNavigate for redirection\nimport{CompanyContext}from'../context/CompanyContext';// Import CompanyContext\nimport AuthContext from'../context/AuthContext';// Import AuthContext\nimport ClientBox from'./ClientBox';// Import ClientBox component\nimport'./Dashboard.css';// Import Dashboard.css for styling\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Dashboard=()=>{const{COMPANY_MAPPING,allCalls}=useContext(CompanyContext);// Access data from CompanyContext\nconst{userRole,companyId}=useContext(AuthContext);// Access userRole and companyId from AuthContext\nconst[clientCallCounts,setClientCallCounts]=useState([]);const[showMore,setShowMore]=useState(false);const navigate=useNavigate();// For navigation\nuseEffect(()=>{// If the user is a client, redirect to their specific client detail page\nif(userRole==='client'){navigate(\"/client/\".concat(companyId));return;// Stop execution if redirecting\n}if(userRole==='admin'&&COMPANY_MAPPING){// Use context data to compute call counts\nconst thirtyDaysAgo=new Date();thirtyDaysAgo.setDate(thirtyDaysAgo.getDate()-30);const callCounts=Object.keys(COMPANY_MAPPING).reduce((acc,companyId)=>{const callsForCompany=allCalls[companyId]||[];const recentCallsCount=callsForCompany.filter(call=>new Date(call.start_time)>=thirtyDaysAgo).length;acc[companyId]=recentCallsCount;return acc;},{});const sortedClientCallCounts=Object.keys(COMPANY_MAPPING).map(companyId=>({companyId,companyName:COMPANY_MAPPING[companyId],callCount:callCounts[companyId]||0})).sort((a,b)=>b.callCount-a.callCount);setClientCallCounts(sortedClientCallCounts);}},[userRole,companyId,COMPANY_MAPPING,allCalls,navigate]);const handleShowMore=()=>{setShowMore(!showMore);};if(userRole!=='admin')return null;// Prevent rendering if the user is not an admin\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Client Performance Overview\"}),/*#__PURE__*/_jsx(\"div\",{className:\"client-boxes\",children:clientCallCounts.slice(0,showMore?clientCallCounts.length:8).map(client=>/*#__PURE__*/_jsx(ClientBox,{companyId:client.companyId,companyName:client.companyName,totalCalls:client.callCount},client.companyId))}),clientCallCounts.length>8&&/*#__PURE__*/_jsx(\"button\",{className:\"show-more-button\",onClick:handleShowMore,children:showMore?'Show Less':'Show More'})]});};export default Dashboard;","map":{"version":3,"names":["React","useContext","useState","useEffect","useNavigate","CompanyContext","AuthContext","ClientBox","jsx","_jsx","jsxs","_jsxs","Dashboard","COMPANY_MAPPING","allCalls","userRole","companyId","clientCallCounts","setClientCallCounts","showMore","setShowMore","navigate","concat","thirtyDaysAgo","Date","setDate","getDate","callCounts","Object","keys","reduce","acc","callsForCompany","recentCallsCount","filter","call","start_time","length","sortedClientCallCounts","map","companyName","callCount","sort","a","b","handleShowMore","className","children","slice","client","totalCalls","onClick"],"sources":["/Users/jerryvohrer/bespoke-work/front-end-pit/src/components/Dashboard.js"],"sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom'; // Import useNavigate for redirection\nimport { CompanyContext } from '../context/CompanyContext'; // Import CompanyContext\nimport AuthContext from '../context/AuthContext'; // Import AuthContext\nimport ClientBox from './ClientBox'; // Import ClientBox component\nimport './Dashboard.css'; // Import Dashboard.css for styling\n\n\nconst Dashboard = () => {\n  const { COMPANY_MAPPING, allCalls } = useContext(CompanyContext); // Access data from CompanyContext\n  const { userRole, companyId } = useContext(AuthContext); // Access userRole and companyId from AuthContext\n  const [clientCallCounts, setClientCallCounts] = useState([]);\n  const [showMore, setShowMore] = useState(false);\n  const navigate = useNavigate(); // For navigation\n\n  useEffect(() => {\n    // If the user is a client, redirect to their specific client detail page\n    if (userRole === 'client') {\n      navigate(`/client/${companyId}`);\n      return; // Stop execution if redirecting\n    }\n\n    if (userRole === 'admin' && COMPANY_MAPPING) {\n      // Use context data to compute call counts\n      const thirtyDaysAgo = new Date();\n      thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n      const callCounts = Object.keys(COMPANY_MAPPING).reduce((acc, companyId) => {\n        const callsForCompany = allCalls[companyId] || [];\n        const recentCallsCount = callsForCompany.filter(call => new Date(call.start_time) >= thirtyDaysAgo).length;\n        acc[companyId] = recentCallsCount;\n        return acc;\n      }, {});\n\n      const sortedClientCallCounts = Object.keys(COMPANY_MAPPING).map(companyId => ({\n        companyId,\n        companyName: COMPANY_MAPPING[companyId],\n        callCount: callCounts[companyId] || 0\n      })).sort((a, b) => b.callCount - a.callCount);\n\n      setClientCallCounts(sortedClientCallCounts);\n    }\n  }, [userRole, companyId, COMPANY_MAPPING, allCalls, navigate]);\n\n  const handleShowMore = () => {\n    setShowMore(!showMore);\n  };\n\n  if (userRole !== 'admin') return null; // Prevent rendering if the user is not an admin\n\n  return (\n    <div className=\"dashboard\">\n      <h1>Client Performance Overview</h1>\n      <div className=\"client-boxes\">\n        {clientCallCounts\n          .slice(0, showMore ? clientCallCounts.length : 8)\n          .map(client => (\n            <ClientBox key={client.companyId} companyId={client.companyId} companyName={client.companyName} totalCalls={client.callCount} />\n          ))}\n      </div>\n      {clientCallCounts.length > 8 && (\n        <button className=\"show-more-button\" onClick={handleShowMore}>\n          {showMore ? 'Show Less' : 'Show More'}\n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default Dashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}