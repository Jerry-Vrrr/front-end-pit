{"ast":null,"code":"var _jsxFileName = \"/Users/jerryvohrer/bespoke-work/front-end-pit/frontend/frontend/src/context/CompanyContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst COMPANY_MAPPING = {\n  \"475663645\": \"Apricot\",\n  \"432770919\": \"Brock\",\n  \"754688700\": \"Brown Chiari\",\n  \"707808192\": \"Conger\",\n  \"196651924\": \"CPJ\",\n  \"408997789\": \"Crowell\",\n  \"788957891\": \"Greenstein Pittari\",\n  \"435195417\": \"Greenberg\",\n  \"294642214\": \"KLAW\",\n  \"533921350\": \"Kohan Bablove\",\n  \"316384868\": \"Lewis\",\n  \"612344072\": \"Lopez Humphries\",\n  \"595022144\": \"Mahoney\",\n  \"258732157\": \"Money\",\n  \"427975086\": \"Rozas\",\n  \"847306783\": \"Trust\"\n};\nexport const CompanyContext = /*#__PURE__*/createContext();\nexport const CompanyProvider = ({\n  children\n}) => {\n  _s();\n  const [selectedCompany, setSelectedCompany] = useState(\"475663645\"); // Default to first company\n  const [totalCalls, setTotalCalls] = useState({});\n  const [callsLast24Hours, setCallsLast24Hours] = useState({});\n  const [trend24Hours, setTrend24Hours] = useState({});\n  const [trend30Days, setTrend30Days] = useState({});\n  const [entriesLast24Hours, setEntriesLast24Hours] = useState({}); // State to store entries count\n  const [gravityFormEntries, setGravityFormEntries] = useState([]); // State to store all Gravity Form entries\n\n  const fetchCallData = async companyId => {\n    try {\n      const response = await axios.get(`http://localhost:3000/api/v1/call_rail_data?company_id=${companyId}`);\n      const calls = response.data;\n\n      // Filter calls from the last 30 days\n      const thirtyDaysAgo = new Date();\n      thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n      const recentCalls = calls.filter(call => new Date(call.start_time) >= thirtyDaysAgo);\n      setTotalCalls(prev => ({\n        ...prev,\n        [companyId]: recentCalls.length\n      }));\n\n      // Filter calls from the last 24 hours\n      const twentyFourHoursAgo = new Date();\n      twentyFourHoursAgo.setDate(twentyFourHoursAgo.getDate() - 1);\n      const recent24HourCalls = calls.filter(call => new Date(call.start_time) >= twentyFourHoursAgo);\n      setCallsLast24Hours(prev => ({\n        ...prev,\n        [companyId]: recent24HourCalls.length\n      }));\n\n      // Calculate trends\n      const previousThirtyDaysAgo = new Date();\n      previousThirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n      const previous30DaysCalls = calls.filter(call => new Date(call.start_time) >= previousThirtyDaysAgo && new Date(call.start_time) < thirtyDaysAgo);\n      const previous30DaysCount = previous30DaysCalls.length;\n      setTrend30Days(prev => ({\n        ...prev,\n        [companyId]: recentCalls.length > previous30DaysCount ? 'up' : 'down'\n      }));\n      const previous24HoursAgo = new Date();\n      previous24HoursAgo.setDate(twentyFourHoursAgo.getDate() - 1);\n      const previous24HoursCalls = calls.filter(call => new Date(call.start_time) >= previous24HoursAgo && new Date(call.start_time) < twentyFourHoursAgo);\n      const previous24HoursCount = previous24HoursCalls.length;\n      setTrend24Hours(prev => ({\n        ...prev,\n        [companyId]: recent24HourCalls.length > previous24HoursCount ? 'up' : 'down'\n      }));\n    } catch (error) {\n      console.error('Error fetching the call data', error);\n    }\n  };\n  const fetchGravityFormsData = async () => {\n    try {\n      const response = await axios.get('http://localhost:3000/api/v1/gravity_forms/entries');\n      const entries = response.data;\n\n      // Process entries to count the number of new chats for each company in the last 24 hours\n      const twentyFourHoursAgo = new Date();\n      twentyFourHoursAgo.setDate(twentyFourHoursAgo.getDate() - 7);\n      const newEntries = {};\n      entries.forEach(entry => {\n        const companyId = entry.company_id; // Ensure this matches the attribute name in your entries\n        if (new Date(entry.date_created) >= twentyFourHoursAgo) {\n          if (!newEntries[companyId]) {\n            newEntries[companyId] = 0;\n          }\n          newEntries[companyId]++;\n        }\n      });\n      setEntriesLast24Hours(newEntries);\n      setGravityFormEntries(entries); // Store all entries in state\n    } catch (error) {\n      console.error('Error fetching Gravity Forms data:', error);\n    }\n  };\n  useEffect(() => {\n    fetchCallData(selectedCompany);\n    fetchGravityFormsData();\n  }, [selectedCompany]);\n  return /*#__PURE__*/_jsxDEV(CompanyContext.Provider, {\n    value: {\n      selectedCompany,\n      setSelectedCompany,\n      COMPANY_MAPPING,\n      totalCalls,\n      callsLast24Hours,\n      trend24Hours,\n      trend30Days,\n      setTrend24Hours,\n      setTrend30Days,\n      entriesLast24Hours,\n      gravityFormEntries // Provide the entries to the context\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n};\n_s(CompanyProvider, \"V9Pk3ecwisa+OPbdXCEh6IHIM8w=\");\n_c = CompanyProvider;\nvar _c;\n$RefreshReg$(_c, \"CompanyProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","axios","jsxDEV","_jsxDEV","COMPANY_MAPPING","CompanyContext","CompanyProvider","children","_s","selectedCompany","setSelectedCompany","totalCalls","setTotalCalls","callsLast24Hours","setCallsLast24Hours","trend24Hours","setTrend24Hours","trend30Days","setTrend30Days","entriesLast24Hours","setEntriesLast24Hours","gravityFormEntries","setGravityFormEntries","fetchCallData","companyId","response","get","calls","data","thirtyDaysAgo","Date","setDate","getDate","recentCalls","filter","call","start_time","prev","length","twentyFourHoursAgo","recent24HourCalls","previousThirtyDaysAgo","previous30DaysCalls","previous30DaysCount","previous24HoursAgo","previous24HoursCalls","previous24HoursCount","error","console","fetchGravityFormsData","entries","newEntries","forEach","entry","company_id","date_created","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/jerryvohrer/bespoke-work/front-end-pit/frontend/frontend/src/context/CompanyContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst COMPANY_MAPPING = {\n  \"475663645\": \"Apricot\",\n  \"432770919\": \"Brock\",\n  \"754688700\": \"Brown Chiari\",\n  \"707808192\": \"Conger\",\n  \"196651924\": \"CPJ\",\n  \"408997789\": \"Crowell\",\n  \"788957891\": \"Greenstein Pittari\",\n  \"435195417\": \"Greenberg\",\n  \"294642214\": \"KLAW\",\n  \"533921350\": \"Kohan Bablove\",\n  \"316384868\": \"Lewis\",\n  \"612344072\": \"Lopez Humphries\",\n  \"595022144\": \"Mahoney\",\n  \"258732157\": \"Money\",\n  \"427975086\": \"Rozas\",\n  \"847306783\": \"Trust\"\n};\n\nexport const CompanyContext = createContext();\n\nexport const CompanyProvider = ({ children }) => {\n  const [selectedCompany, setSelectedCompany] = useState(\"475663645\"); // Default to first company\n  const [totalCalls, setTotalCalls] = useState({});\n  const [callsLast24Hours, setCallsLast24Hours] = useState({});\n  const [trend24Hours, setTrend24Hours] = useState({});\n  const [trend30Days, setTrend30Days] = useState({});\n  const [entriesLast24Hours, setEntriesLast24Hours] = useState({}); // State to store entries count\n  const [gravityFormEntries, setGravityFormEntries] = useState([]); // State to store all Gravity Form entries\n\n  const fetchCallData = async (companyId) => {\n    try {\n      const response = await axios.get(`http://localhost:3000/api/v1/call_rail_data?company_id=${companyId}`);\n      const calls = response.data;\n\n      // Filter calls from the last 30 days\n      const thirtyDaysAgo = new Date();\n      thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n      \n      const recentCalls = calls.filter(call => new Date(call.start_time) >= thirtyDaysAgo);\n      setTotalCalls(prev => ({ ...prev, [companyId]: recentCalls.length }));\n\n      // Filter calls from the last 24 hours\n      const twentyFourHoursAgo = new Date();\n      twentyFourHoursAgo.setDate(twentyFourHoursAgo.getDate() - 1);\n\n      const recent24HourCalls = calls.filter(call => new Date(call.start_time) >= twentyFourHoursAgo);\n      setCallsLast24Hours(prev => ({ ...prev, [companyId]: recent24HourCalls.length }));\n\n      // Calculate trends\n      const previousThirtyDaysAgo = new Date();\n      previousThirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n      const previous30DaysCalls = calls.filter(call => new Date(call.start_time) >= previousThirtyDaysAgo && new Date(call.start_time) < thirtyDaysAgo);\n      const previous30DaysCount = previous30DaysCalls.length;\n      setTrend30Days(prev => ({ ...prev, [companyId]: recentCalls.length > previous30DaysCount ? 'up' : 'down' }));\n\n      const previous24HoursAgo = new Date();\n      previous24HoursAgo.setDate(twentyFourHoursAgo.getDate() - 1);\n      const previous24HoursCalls = calls.filter(call => new Date(call.start_time) >= previous24HoursAgo && new Date(call.start_time) < twentyFourHoursAgo);\n      const previous24HoursCount = previous24HoursCalls.length;\n      setTrend24Hours(prev => ({ ...prev, [companyId]: recent24HourCalls.length > previous24HoursCount ? 'up' : 'down' }));\n    } catch (error) {\n      console.error('Error fetching the call data', error);\n    }\n  };\n\n  const fetchGravityFormsData = async () => {\n    try {\n      const response = await axios.get('http://localhost:3000/api/v1/gravity_forms/entries');\n      const entries = response.data;\n\n      // Process entries to count the number of new chats for each company in the last 24 hours\n      const twentyFourHoursAgo = new Date();\n      twentyFourHoursAgo.setDate(twentyFourHoursAgo.getDate() - 7);\n\n      const newEntries = {};\n      entries.forEach(entry => {\n        const companyId = entry.company_id; // Ensure this matches the attribute name in your entries\n        if (new Date(entry.date_created) >= twentyFourHoursAgo) {\n          if (!newEntries[companyId]) {\n            newEntries[companyId] = 0;\n          }\n          newEntries[companyId]++;\n        }\n      });\n\n      setEntriesLast24Hours(newEntries);\n      setGravityFormEntries(entries); // Store all entries in state\n    } catch (error) {\n      console.error('Error fetching Gravity Forms data:', error);\n    }\n  };\n\n  useEffect(() => {\n    fetchCallData(selectedCompany);\n    fetchGravityFormsData();\n  }, [selectedCompany]);\n\n  return (\n    <CompanyContext.Provider value={{ \n      selectedCompany, \n      setSelectedCompany, \n      COMPANY_MAPPING, \n      totalCalls, \n      callsLast24Hours,\n      trend24Hours,\n      trend30Days,\n      setTrend24Hours, \n      setTrend30Days,\n      entriesLast24Hours,\n      gravityFormEntries // Provide the entries to the context\n    }}>\n      {children}\n    </CompanyContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}